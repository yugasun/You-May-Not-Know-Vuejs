<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>你也许不知道的 Vuejs | 使用ES6快乐的玩耍</title>
    <meta name="description" content="Vue 从入门到精通系列">
    <link rel="icon" href="/You-May-Not-Know-Vuejs/logo.png">
  <script async="async" type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?22a0ab0b25c4b63f25e294e1585f3aa5";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();</script>
    
    <link rel="preload" href="/You-May-Not-Know-Vuejs/assets/css/styles.636033f1.css" as="style"><link rel="preload" href="/You-May-Not-Know-Vuejs/assets/js/app.636033f1.js" as="script"><link rel="preload" href="/You-May-Not-Know-Vuejs/assets/js/17.14df2db4.js" as="script"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/css/1.styles.d7e0337a.css"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/1.d7e0337a.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/10.6ce6cf04.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/11.a0c92858.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/12.7d4c9781.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/13.c15113c9.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/14.f14af779.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/15.f98ca526.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/16.0756c5e1.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/18.5c2715c0.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/19.b277ba6f.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/2.20d5ee32.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/20.adab3611.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/3.bda80ff8.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/4.2b6993a1.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/5.b42c65dc.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/6.d7819112.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/7.be44d24b.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/8.48b0d968.js"><link rel="prefetch" href="/You-May-Not-Know-Vuejs/assets/js/9.87cbe311.js">
    <link rel="stylesheet" href="/You-May-Not-Know-Vuejs/assets/css/styles.636033f1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/You-May-Not-Know-Vuejs/" class="home-link router-link-active"><!----><span class="site-name">
      你也许不知道的 Vuejs
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/You-May-Not-Know-Vuejs/art/" class="nav-link router-link-active">正文</a></div><div class="nav-item"><a href="/You-May-Not-Know-Vuejs/donate/" class="nav-link">人之初</a></div><div class="nav-item"><a href="/You-May-Not-Know-Vuejs/about/" class="nav-link">关于</a></div><a href="https://github.com/yugasun/You-May-Not-Know-Vuejs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/You-May-Not-Know-Vuejs/art/" class="nav-link router-link-active">正文</a></div><div class="nav-item"><a href="/You-May-Not-Know-Vuejs/donate/" class="nav-link">人之初</a></div><div class="nav-item"><a href="/You-May-Not-Know-Vuejs/about/" class="nav-link">关于</a></div><a href="https://github.com/yugasun/You-May-Not-Know-Vuejs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><a href="/You-May-Not-Know-Vuejs/art/" aria-current="page" class="sidebar-link">前言</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-1.html" class="sidebar-link">花式渲染目标元素</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-2.html" class="sidebar-link">深入浅出响应式系统</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-3.html" class="sidebar-link">强大的指令系统</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-4.html" class="sidebar-link">组件式开发</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-5.html" class="sidebar-link">工欲善其事必先利其器</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-6.html" class="sidebar-link">单文件组件</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-7.html" aria-current="page" class="active sidebar-link">使用ES6快乐的玩耍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-7.html#什么是es6" class="sidebar-link">什么是ES6</a></li><li class="sidebar-sub-header"><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-7.html#模块的定义和引入" class="sidebar-link">模块的定义和引入</a></li><li class="sidebar-sub-header"><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-7.html#异步编程" class="sidebar-link">异步编程</a></li><li class="sidebar-sub-header"><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-7.html#高级异步编程" class="sidebar-link">高级异步编程</a></li><li class="sidebar-sub-header"><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-7.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-7.html#专题目录" class="sidebar-link">专题目录</a></li></ul></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-8.html" class="sidebar-link">使用ESLint检查代码质量</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-9.html" class="sidebar-link">定制开发项目模板</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-10.html" class="sidebar-link">插件开发</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-11.html" class="sidebar-link">自定义路由实现</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-12.html" class="sidebar-link">状态管理</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-13.html" class="sidebar-link">最佳实践(1)</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-14.html" class="sidebar-link">最佳实践(2)</a></li><li><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-15.html" class="sidebar-link">最佳实践(3)</a></li></ul></div><div class="page"><div class="content"><h1 id="使用es6快乐的玩耍"><a href="#使用es6快乐的玩耍" aria-hidden="true" class="header-anchor">#</a> 使用ES6快乐的玩耍</h1><p>上一篇中我们已经学会使用 <code>babel</code> 将 ES6 转化为 ES5 了，并且展示了一些 ES6 代码，这一篇将重点聊聊 ES6 在 Vuejs 项目中一些部分应用。</p><h2 id="什么是es6"><a href="#什么是es6" aria-hidden="true" class="header-anchor">#</a> 什么是ES6</h2><p>摘自 <a href="http://es6.ruanyifeng.com/#docs/intro" target="_blank" rel="noopener noreferrer">ECMAScript 6 简介</a>：</p><blockquote><p>大家习惯将 <code>ECMAScript 6.0</code> 简称为 <code>ES6</code>，它是 Javascript 语言的下一代标准，它的目标，是使得 Javascript 语言可以用来编写复杂的大型应用程序，成为企业级开发语言。</p></blockquote><p>说是下一代，其实早在 2015 年 6月就正式发布了（所以又称 <code>ES2015</code>），截止今日已经快3年了，很快 ES7/ES8 都要出来了，所以作为前端开发者，学习 ES6 已经是个必然命题了。不要再问有没有必要学习之类的问题了。</p><p>关于 ES6 的基础知识，推荐 <code>阮一峰</code> 老师的 <a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener noreferrer">ECMAScript 6 入门</a>，看完你就会觉得，并不难。至于有些后端的朋友跟我聊到说 ES6 完全不明白，那是因为你们思想还停留在过去 <code>jQuery</code> 的时代，那个时候只需要随便复制几段代码，然后写几个 js 函数，就可以搞定很多后端模板页面了，但是今非昔比了，所以如果你们想深入了解前端，做一个全栈工程师，还是静下心来，好好阅读这篇 ES6 教程。代码这东西，不只是需要会用，更重要的是需要知其所以然。就像你一个 python 同事看到一段代码时问我，为啥 JS 引用一个模块时是 <code>import Vue form 'vue'</code>，而不是 <code>from 'vue' import Vue</code> 一样，这个我是没法解释的，因为ES6语言的规范就是这样的啊~</p><h2 id="模块的定义和引入"><a href="#模块的定义和引入" aria-hidden="true" class="header-anchor">#</a> 模块的定义和引入</h2><p>复制一份上一篇中的项目，在 <code>src</code> 目录下创建一个 <code>utils.js</code> 文件，内容如下：</p><pre class="language-js"><code><span class="token comment">/**
 * 简单的深拷贝实现，个人经常这么使用
 * 这里obj中不能包含特殊类型值：undefined,NaN,function类型值
 * @param {object} obj
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * log 函数的二次封装，这里只是为了演示
 * @param {any} content
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`[Yuga log]: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>它就是通过 <code>export</code> 暴露出了两个工具函数。</p><p>修改 <code>app.js</code> 代码进行引入使用：</p><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'./styles/app.scss'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> userinfo <span class="token keyword">from</span> <span class="token string">'./info'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> deepClone <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./utils'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> utils <span class="token keyword">from</span> <span class="token string">'./utils'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> hello1 <span class="token keyword">from</span> <span class="token string">'./hello1.vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> hello2 <span class="token keyword">from</span> <span class="token string">'./hello2.vue'</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token punctuation">:</span> <span class="token string">&quot;#app&quot;</span><span class="token punctuation">,</span>
  template<span class="token punctuation">:</span> <span class="token string">'&lt;div&gt;&lt;hello1 v-bind:info=&quot;userinfo&quot;/&gt;&lt;hello2/&gt;&lt;/div&gt;'</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      userinfo<span class="token punctuation">:</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>userinfo<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    hello1<span class="token punctuation">,</span>
    hello2
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 你会发现这里也同时改变了源原数据 info ，</span>
    <span class="token comment">// 所以需要用到深拷贝源数据赋值给 data 中的 info</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userinfo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'yugasun111'</span>
    utils<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userinfo<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>上面分别演示了 5 种模块引入方法，无论是哪一种，其实这个要看该模块是如何 <code>export</code> 的，对于任何一个 npm 模块，如果它支持 ES6 方式引入，它一般都会使用 <code>export</code> 或 <code>export default</code> 关键字暴露出一个对象（任何一个js数据类型），只不过 <code>export default</code> 指定了默认输出，这样用户就不用阅读接口文档，就可以按照自己需要加载该模块，并修改为自己喜欢的名称来使用。而对于有些模块（如上面的 <code>utils.js</code>）可以通过 <code>export</code> 关键字来实现多个子模块的输出，这样用户就可以根据个人需要来引入对应的子模块，前提是得知道其内部子模块名称才行。
而 <code>import 'normalize.css'</code> 相当于全局引入了，将该模块的所有内容一并引入。</p><blockquote><p>更多细节讲解，建议阅读这篇文章： <a href="http://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener noreferrer">ES6 Module 的语法</a></p></blockquote><p>这点对于 <code>require</code> 的引入方式，是没法做到的，而著名的 <a href="https://doc.webpack-china.org/guides/tree-shaking/" target="_blank" rel="noopener noreferrer">tree-shaking</a> 功能就是依赖 ES6 的这种模块系统。</p><h2 id="异步编程"><a href="#异步编程" aria-hidden="true" class="header-anchor">#</a> 异步编程</h2><blockquote><p><code>Promise</code> 是异步编程的一种解决方案，比传统的解决方案（回调函数）更合理和更强大。它由社区最早提出和实现，ES6 将其写进了语言标准，统一了用法，原生提供了 <code>Promise</code> 对象。深入了解<code>Promise</code> 可以阅读这篇博文：<a href="https://yugasun.com/post/async-programming-promise.html" target="_blank" rel="noopener noreferrer">异步编程之 Promise</a>；
ES2017 标准又引入了 async 函数，是的异步操作变得更加方便。更详细的介绍在这里：<a href="http://es6.ruanyifeng.com/#docs/async" target="_blank" rel="noopener noreferrer">async 函数</a>。</p></blockquote><p>有的人说有了 <code>async 函数</code> 就不再需要 <code>Promise</code> 了，我觉得是不对的，因为很多异步模块都是先基于 <code>Promise</code> 封装，然后才能经过  <code>async/await</code> 函数来操作的。当然把两者结合起来用，可以完成更加强大的异步编程操作，Vuejs 代码也变得更加灵活、简介和强大。</p><p>这里既然是 Vuejs 实战，我就不讲它们的基础用法了，来看看如何用在实际项目中吧~</p><p>要想在项目中使用 <code>async/await</code> 函数，就必须有相关 <code>babel</code> 插件来支持，因为 <code>async/await</code> 语法属于 ES2017 规范的内容，所以需要引入 <code>babel-preset-stage-2</code> 插件来转化，当然还有 <code>stage-0, stage-1, stage-3</code> 等，这里参考 <code>vue-cli</code> 常用 <code>stage-2</code>，直接安装：</p><pre class="language-js"><code>npm install babel<span class="token operator">-</span>preset<span class="token operator">-</span>stage<span class="token operator">-</span><span class="token number">2</span> babel<span class="token operator">-</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre><p>然后在 <code>.babelrc</code> 文件中添加配置：</p><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;env&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;stage-2&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;transform-runtime&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><p>现在我们的语言支持，配置好了，现在开始使用。</p><p>上面的代码中，我们的 <code>userinfo</code> 是我们通过 <code>info.js</code> 硬编码，然后在 <code>app.js</code> 中引入，通过 <code>props</code> 传递给了 <code>hello1.vue</code> 组件，下面我们通过请求接口方式来获取。</p><p>先安装 <code>vue-axios-plugin</code> 插件，来提供网络请求服务：</p><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> vue-axios-plugin --save
</code></pre><p>然后在 <code>app.js</code> 中导入并使用：</p><pre class="language-js"><code><span class="token comment">// 引入插件</span>
<span class="token keyword">import</span> VueAxiosPlugin <span class="token keyword">from</span> <span class="token string">'vue-axios-plugin'</span><span class="token punctuation">;</span>
<span class="token comment">// 使用插件</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueAxiosPlugin<span class="token punctuation">)</span>
</code></pre><p>这样在应用中的组件中都会在 <code>this</code> 上绑定一个 <code>$http</code> 属性，它由 <code>get</code> 和 <code>post</code> 方法，具体使用文档：<a href="https://github.com/yugasun/vue-axios-plugin" target="_blank" rel="noopener noreferrer">vue-axios-plugin文档</a>。</p><p>然后在 <code>hello1.vue</code> 中创建请求方法 <code>getUserInfo</code>，并在 <code>created</code> 钩子函数中调用:</p><pre class="language-js"><code><span class="token comment">// ...</span>
methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">getUserInfo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'http://yapi.demo.qunar.com/mock/4377/userinfo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>info <span class="token operator">=</span> res<span class="token punctuation">.</span>data
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// ...</span>
</code></pre><p>重新运行项目，审核元素，发现成功发起了 <code>GET</code> 请求，并显示了接口数据。</p><blockquote><p>注意：其实 Vuejs 的 <code>methods</code> 属性中所有的方法都可以定义为 <code>async函数</code> 来使用，包括 Vuejs 的生命周期函数，比如 <code>created</code>。</p></blockquote><p>可以发现使用 <code>async/await</code> 语法比使用 <code>Promise</code> 的链式语法简洁多了，而且阅读性更强了。</p><h2 id="高级异步编程"><a href="#高级异步编程" aria-hidden="true" class="header-anchor">#</a> 高级异步编程</h2><p>因为本人工作主要是在大数据可视化，经常在绘制某张定制化图形时，需要同时依赖多个接口（<code>不要问我为什么会有这么多接口？为啥后端不一次性传给我？因为我不想跟他们撕逼，╮(╯▽╰)╭哎</code>），而且必须在这几个请求都处理完后，才能开始处理数据，多的时候一张图行依赖6个接口，当然我可以在一个 <code>async函数</code> 中写6行 <code>await</code> 语法的请求，然后逐个处理，但是这样效率太低了，但是这6个请求是可以并行执行的。这时就可以结合 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/all" target="_blank" rel="noopener noreferrer">Promise.all</a> 高级方法来处理。这样我可以同时发起六个请求，然后统一处理接口返回数据。为了方便，这里演示同时请求2个url，多个的是一样的。我们再在 <code>hello1.vue</code> 中添加一个 <code>get2UserInfo</code> 方法，然后在 <code>created</code> 中调用下，更新后的 <code>hello1.vue</code> 如下：</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>{{ msg }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>info.site<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ info.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>user1.site<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ user1.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>user2.site<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ user2.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'hello1'</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      msg<span class="token punctuation">:</span> <span class="token string">'Hello Vue.js'</span><span class="token punctuation">,</span>
      info<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      user1<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      user2<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token function">getUserInfo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'http://yapi.demo.qunar.com/mock/4377/userinfo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>info <span class="token operator">=</span> res<span class="token punctuation">.</span>data
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">async</span> <span class="token function">get2UserInfo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'http://yapi.demo.qunar.com/mock/4377/userinfo1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'http://yapi.demo.qunar.com/mock/4377/userinfo2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>user1 <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>user2 <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get2UserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
<span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> $green<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>再次运行项目，可以发现页面在初始化的时候同时发起了3个请求，并正常渲染出了接口数据。通过控制台可以看到这三个请求是并行发起的。</p><blockquote><p>注意：这里的 <code>Promise.all()</code> 的参数是一个函数执行队列，它们会同时发起，然后都请求成功后，会将队列的每个任务的结果组装成一个结果数据，然后返回。</p></blockquote><h2 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h2><p>其实要把讲ES6讲完，实在是太难了，写本书都很难讲好，我这里只能说是班门弄斧一下，结合我在 Vue 中的相关实践，对相关功能做个简短介绍，希望能起到引导的作用。不太了解的朋友，可以认真阅读下文首提到的阮一峰老师的文章。接下来后面的文章将全部使用 ES6 的语法编写代码。</p><p><a href="https://github.com/yugasun/You-May-Not-Know-Vuejs/blob/master/chapter2/3" target="_blank" rel="noopener noreferrer">源码在此</a></p><h2 id="专题目录"><a href="#专题目录" aria-hidden="true" class="header-anchor">#</a> 专题目录</h2><p><a href="https://github.com/yugasun/You-May-Not-Know-Vuejs#%E6%96%87%E7%AB%A0%E7%9B%B4%E9%80%9A%E8%BD%A6" target="_blank" rel="noopener noreferrer">You-May-Not-Know-Vuejs</a></p></div><div class="content edit-link"><a href="https://github.com/yugasun/You-May-Not-Know-Vuejs/edit/master/docs/art/you-may-not-know-vuejs-7.md" target="_blank" rel="noopener noreferrer">错别字纠正</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-6.html" class="prev">
          单文件组件
        </a></span><span class="next"><a href="/You-May-Not-Know-Vuejs/art/you-may-not-know-vuejs-8.html">
          使用ESLint检查代码质量
        </a> →
      </span></p></div></div></div></div>
    <script src="/You-May-Not-Know-Vuejs/assets/js/app.636033f1.js" defer></script><script src="/You-May-Not-Know-Vuejs/assets/js/17.14df2db4.js" defer></script>
  </body>
</html>
